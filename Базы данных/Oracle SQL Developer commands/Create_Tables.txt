-- Generated by Oracle SQL Developer Data Modeler 17.2.0.188.1059
--   at:        2018-05-19 16:25:34 MSK
--   site:      Oracle Database 11g
--   type:      Oracle Database 11g



CREATE TABLE chain_stores (
    chain_store_id   NUMBER NOT NULL,
    chain_name       CHAR(20 CHAR)
);

ALTER TABLE chain_stores ADD CONSTRAINT chain_stores_pk PRIMARY KEY ( chain_store_id );

CREATE TABLE "Order" (
    order_id           NUMBER NOT NULL,
    store_id           NUMBER NOT NULL,
    status             CHAR(1 CHAR),
    storage_id         NUMBER NOT NULL,
    order_date         TIMESTAMP,
    order_close_date   TIMESTAMP
);

ALTER TABLE "Order" ADD CONSTRAINT order_pk PRIMARY KEY ( order_id );

CREATE TABLE order_product (
    order_product_id     NUMBER NOT NULL,
    storage_product_id   NUMBER NOT NULL,
    count                NUMBER,
    order_id             NUMBER NOT NULL
);

ALTER TABLE order_product ADD CONSTRAINT order_product_pk PRIMARY KEY ( order_product_id );

CREATE TABLE product (
    product_id   NUMBER NOT NULL,
    name         NUMBER,
    price        NUMBER
);

ALTER TABLE product ADD CONSTRAINT product_pk PRIMARY KEY ( product_id );

CREATE TABLE storage (
    storage_id   NUMBER NOT NULL,
    balance      NUMBER,
    name         CHAR(20 CHAR),
    main_user    NUMBER NOT NULL
);

ALTER TABLE storage ADD CONSTRAINT storage_pk PRIMARY KEY ( storage_id );

CREATE TABLE storage_order (
    storage_order_id   NUMBER NOT NULL,
    storage_id         NUMBER NOT NULL,
    status             CHAR(1 CHAR),
    open_date          TIMESTAMP,
    close_date         TIMESTAMP
);

ALTER TABLE storage_order ADD CONSTRAINT storage_order_pk PRIMARY KEY ( storage_order_id );

CREATE TABLE storage_order_product (
    storage_order_product_id   NUMBER NOT NULL,
    product_id                 NUMBER NOT NULL,
    count                      NUMBER,
    storage_order_id           NUMBER NOT NULL
);

ALTER TABLE storage_order_product ADD CONSTRAINT storage_order_product_pk PRIMARY KEY ( storage_order_product_id );

CREATE TABLE storage_product (
    storage_product_id   NUMBER NOT NULL,
    name                 CHAR(30 CHAR) NOT NULL,
    count                NUMBER,
    price                NUMBER,
    storage_id           NUMBER NOT NULL
);

ALTER TABLE storage_product ADD CONSTRAINT storage_product_pk PRIMARY KEY ( storage_product_id );

CREATE TABLE store (
    store_id      NUMBER NOT NULL,
    name          CHAR(20 CHAR),
    address       CHAR(100 CHAR),
    chain_store   NUMBER NOT NULL
);

ALTER TABLE store ADD CONSTRAINT store_pk PRIMARY KEY ( store_id );

CREATE TABLE "User" (
    user_id    NUMBER NOT NULL,
    login      CHAR(20 CHAR),
    password   CHAR(30 CHAR),
    fio        CHAR(50 CHAR),
    status     NUMBER
);

ALTER TABLE "User" ADD CONSTRAINT user_pk PRIMARY KEY ( user_id );

ALTER TABLE order_product
    ADD CONSTRAINT or_prod_stor_prod_fk FOREIGN KEY ( storage_product_id )
        REFERENCES storage_product ( storage_product_id );

ALTER TABLE order_product
    ADD CONSTRAINT order_product_order_fk FOREIGN KEY ( order_id )
        REFERENCES "Order" ( order_id );

ALTER TABLE "Order"
    ADD CONSTRAINT order_storage_fk FOREIGN KEY ( storage_id )
        REFERENCES storage ( storage_id );

ALTER TABLE "Order"
    ADD CONSTRAINT order_store_fk FOREIGN KEY ( store_id )
        REFERENCES store ( store_id );

ALTER TABLE storage_order_product
    ADD CONSTRAINT stor_order_prod_prod_fk FOREIGN KEY ( product_id )
        REFERENCES product ( product_id );

ALTER TABLE storage_order_product
    ADD CONSTRAINT stor_order_prod_stor_order_fk FOREIGN KEY ( storage_order_id )
        REFERENCES storage_order ( storage_order_id );

ALTER TABLE storage_product
    ADD CONSTRAINT storage_product_storage_fk FOREIGN KEY ( storage_id )
        REFERENCES storage ( storage_id );

ALTER TABLE storage
    ADD CONSTRAINT storage_user_fk FOREIGN KEY ( main_user )
        REFERENCES "User" ( user_id );

ALTER TABLE store
    ADD CONSTRAINT store_chain_stores_fk FOREIGN KEY ( chain_store )
        REFERENCES chain_stores ( chain_store_id );

ALTER TABLE storage_order
    ADD CONSTRAINT table_11_storage_fk FOREIGN KEY ( storage_id )
        REFERENCES storage ( storage_id );



-- Oracle SQL Developer Data Modeler Summary Report: 
-- 
-- CREATE TABLE                            10
-- CREATE INDEX                             0
-- ALTER TABLE                             20
-- CREATE VIEW                              0
-- ALTER VIEW                               0
-- CREATE PACKAGE                           0
-- CREATE PACKAGE BODY                      0
-- CREATE PROCEDURE                         0
-- CREATE FUNCTION                          0
-- CREATE TRIGGER                           0
-- ALTER TRIGGER                            0
-- CREATE COLLECTION TYPE                   0
-- CREATE STRUCTURED TYPE                   0
-- CREATE STRUCTURED TYPE BODY              0
-- CREATE CLUSTER                           0
-- CREATE CONTEXT                           0
-- CREATE DATABASE                          0
-- CREATE DIMENSION                         0
-- CREATE DIRECTORY                         0
-- CREATE DISK GROUP                        0
-- CREATE ROLE                              0
-- CREATE ROLLBACK SEGMENT                  0
-- CREATE SEQUENCE                          0
-- CREATE MATERIALIZED VIEW                 0
-- CREATE SYNONYM                           0
-- CREATE TABLESPACE                        0
-- CREATE USER                              0
-- 
-- DROP TABLESPACE                          0
-- DROP DATABASE                            0
-- 
-- REDACTION POLICY                         0
-- 
-- ORDS DROP SCHEMA                         0
-- ORDS ENABLE SCHEMA                       0
-- ORDS ENABLE OBJECT                       0
-- 
-- ERRORS                                   0
-- WARNINGS                                 0
